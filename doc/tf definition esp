ğŸ“„ DocumentaciÃ³n â€” Decisiones sobre el uso de Terraform

ğŸ¯ Contexto

Con la expansiÃ³n de las operaciones en Uruguay, iniciamos la definiciÃ³n de la estrategia para la gestiÃ³n de infraestructura como cÃ³digo (IaC) utilizando Terraform, considerando la realidad local y los aprendizajes adquiridos en Brasil.

Inicialmente pensamos en replicar el modelo brasileÃ±o: un repositorio por mÃ³dulo, donde cada recurso o componente principal tendrÃ­a su propio repositorio dedicado, incluyendo todos los subcomponentes necesarios.

Este enfoque funciona bien en empresas grandes con equipos autÃ³nomos responsables de su propia infraestructura. En Uruguay, concluimos que el escenario es distinto.

ğŸ’¬ Discusiones y cambio de direcciÃ³n

Tras conversaciones con el equipo de Infraestructura y el equipo de The Voice, identificamos que:

El equipo local es pequeÃ±o (4 miembros en Infra/DevOps).

No existen squads autÃ³nomos; toda la gestiÃ³n de infraestructura estÃ¡ centralizada en el equipo de Infra/DevOps.


Por lo tanto, decidimos usar un repositorio Ãºnico por cuenta de producto, centralizando todos los recursos y mÃ³dulos necesarios. Esta elecciÃ³n simplifica la gobernanza, el mantenimiento y permite al equipo enfocarse en mejoras y automatizaciÃ³n.

ğŸ—‚ï¸ Estructura actual definida

Repositorio Ãºnico por cuenta de producto.

OrganizaciÃ³n interna en mÃ³dulos reutilizables.

Ejemplo: EC2, S3, Fargate, roles y VPCs en el mismo repositorio.


âœ… Tabla de pros y contras â€” MÃ³dulos en repositorios separados vs. repositorio Ãºnico

Criterio	Repos separados por mÃ³dulo	Repositorio Ãºnico

AutonomÃ­a por equipo	Alta	Baja, gestiÃ³n centralizada
Escalabilidad organizacional	Alta	Limitada, suficiente
Mantenimiento	Complejo	Simple
Control de deploy	MÃ¡s granular	Centralizado
Velocidad de cambios	Alta	MÃ¡s controlada
Gobernanza	MÃ¡s robusta	MÃ¡s simple


âœ… Tabla de pros y contras â€” Separados por recurso vs. Ãºnico por cuenta

Criterio	Separados por recurso	Ãšnico por cuenta

Aislamiento	Total	Bajo
VisiÃ³n general	Fragmentada	Consolidada
Gobernanza de secrets	Compleja	Centralizada
Complejidad CI/CD	Alta	Baja
Dependencias	Complejas	Simples
Escalabilidad futura	Buena	Puede requerir ajuste


ğŸ’¡ DecisiÃ³n final

Repositorio Ãºnico por cuenta de producto.

OrganizaciÃ³n interna en mÃ³dulos.

Pipelines y gobernanza simplificados.

RevisiÃ³n periÃ³dica a futuro.


ğŸš€ PrÃ³ximos pasos

Documentar la estructura de carpetas y mÃ³dulos.

Configurar pipelines (OIDC y workflows reutilizables).

Implementar aprobaciones manuales para producciÃ³n.

Crear guÃ­as internas para contribuciÃ³n y revisiÃ³n.


âœï¸ ConclusiÃ³n

La estrategia actual estÃ¡ basada en el tamaÃ±o del equipo, simplicidad operativa y visiÃ³n consolidada. Este documento serÃ¡ vivo, actualizÃ¡ndose segÃºn nuevas necesidades y aprendizajes.


---

ğŸ—’ï¸ Template README.md sugerido

# ğŸš€ Nombre del Repositorio

## ğŸ“„ DescripciÃ³n

Repositorio Terraform para la cuenta **<nombre_de_la_cuenta>**. Incluye EC2, S3, Fargate, roles, VPCs y otros recursos relacionados.

## ğŸ—ï¸ Estructura

.
â”œâ”€â”€ main.tf
â”œâ”€â”€ variables.tf
â”œâ”€â”€ outputs.tf
â”œâ”€â”€ versions.tf
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ ec2/
â”‚   â”œâ”€â”€ s3/
â”‚   â”œâ”€â”€ fargate/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ environments/
â”‚   â”œâ”€â”€ dev/
â”‚   â”œâ”€â”€ staging/
â”‚   â””â”€â”€ prod/
â””â”€â”€ README.md

## âš™ï¸ Deploy

```bash
terraform init
terraform fmt -recursive
terraform validate
terraform plan -var-file="environments/dev/dev.tfvars"
terraform apply -var-file="environments/dev/dev.tfvars"

ğŸ” Seguridad

AutenticaciÃ³n con OIDC (GitHub Actions).

Permisos mÃ­nimos necesarios.


ğŸ‘¨â€ğŸ’» ContribuciÃ³n

1. Crear una branch.


2. Realizar cambios.


3. Abrir un Pull Request.


4. Esperar revisiÃ³n.



ğŸ“ Notas

Los cambios en prod requieren aprobaciÃ³n manual.

Seguir las guÃ­as internas oficiales.


ğŸ“ Contacto

Equipo Infra/DevOps â€” <contacto>

Listo para exportar como archivo `.md` y subir a Git.

